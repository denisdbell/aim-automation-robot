*** Settings ***
Library           Selenium2Library
Suite Setup		  Environment setup
Suite Teardown	  Teardown Browser
Resource          ../../../resources/landingpage/landingpage_resource.txt

*** Test Cases ***

#US1137 - truncation
Username should NOT be truncated on the Landing Page
	[Tags]		Truncation
	Given I am a Registered MyBlue Member on the Landing Page
	Sleep		${EVENT}
	Then I should see "#userNameText" have the text "Marchcontract" displayed
	
	
#US1129 - Truncation
Username should NOT be truncated in the Navigation Bar
	[Tags]		Truncation
    Then I should see "span.username" have the text "Marchcontract" displayed
	Teardown Browser
	

#US243, US245, and US246 Test Cases for Desktop
#US1096
#Basic User
LandingPage BHA thermometer for Basic
	[Tags]		BHA
	Given I am a Registered MyBlue Member on the Landing Page
	Then I should see the element "div.bha" displayed

Landing Page BHA Health Check Step for Basic
	[Tags]		BHA
	Then The "div#step1 div.complete" step is completed 

Landing Page BHA Online Coaching Step for Basic
	[Tags]		BHA
	When The "div#step1 div.complete" step is completed 
	Then I should see the element "div#step2 div.incomplete" displayed 	

Landing Page BHA Stick to your plan Step for Basic
	[Tags]		BHA
	Then I should see the element "div#step3[ng-show=\"!isNextStep\"] .incomplete" displayed 	
	And I should not see the element "div#step3 div.go-back #goBackToStep" displayed
	And I should not see the element "div#step3 div.go-back #continueWithThisStep" displayed	
	
Landing Page BHA Health Check Step Go Back Button Valid SSO link for Basic
	[Tags]		BHA
	Then I should see the link "div#step1 div.go-back #goBackToStep" with SSO link "https://${SSO}.fepblue.org${SSO_PORT}/idp/startSSO.ping?PartnerSpId=https://www.webmdhealth.com/sp&TargetResource=https://startid.fepblue.org?value=3563"
	
Landing Page BHA Online Coaching Step Continue with this step Button Valid SSO link for Basic
	[Tags]		BHA	
	Then I should see the link "div#step2 div.go-back #continueWithThisStep" with SSO link "https://${SSO}.fepblue.org${SSO_PORT}/idp/startSSO.ping?PartnerSpId=https://www.webmdhealth.com/sp&TargetResource=https://startid.fepblue.org?value=714"
	Teardown Browser

#Standard User
LandingPage BHA thermometer for Standard
	[Tags]		BHA
	Given I am a Standard Registered MyBlue Member on the Landing Page
	Then I should see the element "div.bha" displayed

Landing Page BHA Health Check Step for Standard
	[Tags]		BHA
	Then I should see the element "div#step1 div.complete" displayed 	
	And I should see the element "div#step1 div.go-back #goBackToStep" displayed

Landing Page BHA Online Coaching Step for Standard
	[Tags]		BHA
	Then I should see the element "div#step2 div.complete" displayed 	
	And I should see the element "div#step2 div.go-back #goBackToStep" displayed
	And I should not see the element "div#step2 div.go-back #continueWithThisStep" displayed		

Landing Page BHA Stick to your plan Step for Standard
	[Tags]		BHA
	Then I should see the element "div#step3[ng-show=\"isNextStep\"] .incomplete" displayed 	
	And I should see the element "div#step3 div.go-back #continueWithThisStep" displayed	

Landing Page BHA Health Check Step Go Back Button Valid SSO link for Standard
	[Tags]		BHA	
	Then I should see the link "div#step1 div.go-back #goBackToStep" with SSO link "https://${SSO}.fepblue.org${SSO_PORT}/idp/startSSO.ping?PartnerSpId=https://www.webmdhealth.com/sp&TargetResource=https://startid.fepblue.org?value=3563"

Landing Page BHA Online Coaching Step Go Back Button Valid SSO link for Standard
	[Tags]		BHA	
	Then I should see the link "div#step2 div.go-back #goBackToStep" with SSO link "https://${SSO}.fepblue.org${SSO_PORT}/idp/startSSO.ping?PartnerSpId=https://www.webmdhealth.com/sp&TargetResource=https://startid.fepblue.org?value=714"

Landing Page BHA Stick to your plan Step Continue with this step Button Valid SSO link for Standard
	[Tags]		BHA	
	Then I should see the link "div#step3 div.go-back #continueWithThisStep" with SSO link "https://${SSO}.fepblue.org${SSO_PORT}/idp/startSSO.ping?PartnerSpId=https://www.webmdhealth.com/sp&TargetResource=https://startid.fepblue.org?value=714"
	Teardown Browser

#Terminated User
LandingPage BHA thermometer for Terminated
	[Tags]		BHA
	Given I am a Terminated Registered MyBlue Member on the Landing Page
	Then I should not see the element "div.bha" displayed
	Teardown Browser

#Minor User
LandingPage BHA thermometer for Minor
	[Tags]		BHA
	Given I am a Minor Registered MyBlue Member on the Landing Page
	Then I should not see the element "div.bha" displayed
	Teardown Browser
	
	
#US486 Test Cases
link to Classic Site Displayed
	[Tags]		ClassicSitelink	
	Given I am a Registered MyBlue Member on the Landing Page
	Then I should see the element "div.backToClassic a" displayed
	

link to Classic Site Navigates to Classic Page
	[Tags]		ClassicSitelink	
	Given I am a Registered MyBlue Member on the Landing Page (Session exists)
	When I Click the "div.backToClassic a" link
	Then I should be navigated to "${MYBLUE}members/myblue/dashboard"
	

User content maintained on Classic Page
	[Tags]		ClassicSitelink	
	Given I am a Registered MyBlue Member on the Landing Page (Session exists)
	When I Click the "div.backToClassic a" link
	Sleep		${NAVIGATION}
	Then I should see "span.username" have the text "Marchcontract" displayed
	
## Pilot link currently hidden
#link to Mdot Site Displayed on Classic Site
#	[Tags]		ClassicSitelink	
#	Given I am a Registered MyBlue Member on the Landing Page (Session exists)
#	When I Click the "div.backToClassic a" link
#	Sleep		5 
#	Then I should see the element "#pilotSiteLink a img" displayed
#	Teardown Browser
	

#US477 - Logout redirect

##Expected to fail, Load balancer not implemented yet
#Logging out of Mdot should take me to MyBlue login page
#	[Tags]		Logout
#	Given I am a Registered MyBlue Member on the Landing Page
#	When I Click the ".username" element
#	And I Click the "li.logout a" link
#	Then I should be navigated to "${SERVER}/login"
#	Teardown Browser

#Logging out of a partner site should take me to MyBlue login page
#	[Tags]		Logout
#	Given I am a Registered MyBlue Member on the Landing Page
#	When I Click the "li#healthAndWellnesslink0 a" link
#	And I Click the ".username" element
#	And I Click the "li.logout a" link
#	Then I should be navigated to "${SERVER}/login"
#	Teardown Browser
	
Logging out of the classic site should take me to classic login page
	[Tags]		Logout
	Given I am a Registered MyBlue Member on the Landing Page
	When I Click the "div.backToClassic a" link
	Sleep		${NAVIGATION}
	And I Click the ".username" element
	And I Click the "li.logout a" link
	Then I should be navigated to "${MYBLUE_LOGIN_URL}"
	Teardown Browser
	
Logging out of a partner site should take me to classic login page
	[Tags]		Logout
	Given I am a Registered MyBlue Member on the Landing Page
	When I Click the "div.backToClassic a" link
	Sleep		${NAVIGATION}
	And I Click the "#viewAccountBalance" link
	Sleep		${NAVIGATION}
	And I Click the ".username" element
	And I Click the "li.logout a" link
	Then I should be navigated to "${MYBLUE_LOGIN_URL}"
	Teardown Browser


#US765: PreNavigation Intersitital
When I click Find a Pharmacy I should see the interstitial
	[Tags]		PreNavInterstitial
	Given I am a Registered MyBlue Member on the Landing Page
	When I Click the "#pharmacylink0 a" link
	Sleep		${NAVIGATION}
	Then I should see the element ".modal-dialog .copy" displayed
	
I should see a message on the interstitial with the following text
	[Tags]		PreNavInterstitial
	Then I should see ".modal-dialog .copy" have the text "You will be going to a new web site, operated on behalf of the Blue Cross and Blue Shield Service Benefit Plan by a third party. The protection of your privacy will be governed by the privacy policy of that site. Please review the terms of use and privacy policies of the new site you will be visiting." displayed
	
I should see an OK button
	[Tags]		PreNavInterstitial
	Then I should see the element "#OK" displayed

I should see a message on the modal
	[Tags]		PreNavInterstitial
	Then I should see the element ".copy" displayed
	
#On classic I should see the pre interstitial when I click Treatment cost
#	[Tags]		PreNavInterstitial1
#	Given I am a Registered MyBlue Member on the Landing Page
#	When I navigate to the classic site
#	And When I Click the "a:contains(' Check Treatment Costs ')" element
#	Sleep		${NAVIGATION}
#	Then I should see the element ".modal-dialog" displayed
	
#On classic I should see the pre interstitial when I click Walking works
#	[Tags]		PreNavInterstitial
#	When I navigate to the classic site
#	And When I Click the ".linkAggregatorContent:nth-child(1) li:nth-child(11) a" link
#	Sleep		${NAVIGATION}
#	Then I should see the element ".modal-dialog" displayed


#US1605
I should see a Change password modal
	[Tags]		ChangePassword
	Given I am a Registered MyBlue Member on the Landing Page
	When I navigate to "${SERVER}/account/change-password"
	Sleep		${NAVIGATION}
	Then I should see the element "form[name=\"mdotChangePasswordForm\"]" displayed
	
I should see the url contain the landing page
	[Tags]		ChangePassword
	Then I should be navigated to "${SERVER}/landingpage"
	
I should see a current password text box
	[Tags]		ChangePassword
	Then I should see the element "#currentPassword" displayed

I should see a new password text box
	[Tags]		ChangePassword
	Then I should see the element "#newPassword" displayed
	
I should see a confirm new password text box
	[Tags]		ChangePassword
	Then I should see the element "#confirmPassword" displayed
	
I should see a cancel link
	[Tags]		ChangePassword
	Then I should see the link "#myblue-account-management-modal-cancel" displayed

I should see a red X if less than 3 characters
	[Tags]		ChangePassword
	When I enter the text "aa" in "#newPassword" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon" displayed

I should see a checkmark if 3 characters or more
	[Tags]		ChangePassword
	When I enter the text "aaaaAaa2" in "#newUsername" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon.success" displayed
	
When I click cancel I should not see the modal
	[Tags]		ChangePassword
	When i click the "#myblue-account-management-modal-cancel" link
	Sleep		${EVENT}
	Then I should not see the element "form[name=\"mdotChangePasswordForm\"]" displayed
	Teardown Browser
	

#US1606: Username Modal
I should see a Change username modal
	[Tags]		ChangeUsername
	Given I am a Registered MyBlue Member on the Landing Page
	When I navigate to "${SERVER}/account/change-username"
	Sleep		${NAVIGATION}
	Then I should see the element "form[name=\"mdotChangeUsernameForm\"]" displayed
	
I should see the url contain the landing page
	[Tags]		ChangeUsername
	Then I should be navigated to "${SERVER}/landingpage"
	
I should see a current username text box
	[Tags]		ChangeUsername
	Then I should see the element "#currentUsername" displayed

I should see a new username text box
	[Tags]		ChangeUsername
	Then I should see the element "#newUsername" displayed
	
I should see a confirm new username text box
	[Tags]		ChangeUsername
	Then I should see the element "#confirmNewUsername" displayed
	
I should see a cancel link
	[Tags]		ChangeUsername
	Then I should see the link "#myblue-account-management-modal-cancel" displayed

I should see a red X if less than 3 characters
	[Tags]		ChangeUsername
	When I enter the text "aa" in "#newUsername" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon" displayed

I should see a checkmark if 3 characters or more
	[Tags]		ChangeUsername
	When I enter the text "aaa" in "#newUsername" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon.success" displayed
	
I should see a red X if has invalid characters
	[Tags]		ChangeUsername
	When I enter the text "@^&#^%^#" in "#newUsername" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon" displayed

## CANT TEST: Event doesnt get triggered by robot
#I should see an enabled submit button
#	[Tags]		ChangeUsername
#	When I enter the text "marchcontract" in "#currentUsername" textbox
#	And I enter the text "marchcontract" in "#newUsername" textbox
#	And I enter the text "marchcontract" in "#confirmNewUsername" textbox
#	Sleep		${EVENT}
#	Then I should see the link ".myblue-btn.btn-secondary" displayed
	
When I click cancel I should not see the modal
	[Tags]		ChangeUsername
	When i click the "#myblue-account-management-modal-cancel" link
	Sleep		${EVENT}
	Then I should not see the element "form[name=\"mdotChangeUsernameForm\"]" displayed
	Teardown Browser
	

#US371: Email Modal
I should see a Change email modal
	[Tags]		ChangeEmail
	Given I am a Registered MyBlue Member on the Landing Page
	When I navigate to "${SERVER}/landingpage?accSettings=change-email"
	Sleep		${NAVIGATION}
	Then I should see the element "form[name=\"f\"]" displayed
	
I should see the url contain the landing page
	[Tags]		ChangeEmail
	Then I should be navigated to "${SERVER}/landingpage"
	
I should see a current email text box
	[Tags]		ChangeEmail
	Then I should see the element "#currentEmailAddress" displayed

I should see a new email text box
	[Tags]		ChangeEmail
	Then I should see the element "#newEmailAddress" displayed
	
I should see a confirm new email text box
	[Tags]		ChangeEmail
	Then I should see the element "#confirmEmailAddress" displayed
	
I should see a cancel link
	[Tags]		ChangeEmail
	Then I should see the link "#myblue-account-management-modal-cancel" displayed

I should see a red X if invalid email
	[Tags]		ChangeEmail
	When I enter the text "aa" in "#newEmailAddress" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon" displayed

I should see a checkmark if valid email
	[Tags]		ChangeEmail
	When I enter the text "aaa@aaa.com" in "#newEmailAddress" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon.success" displayed
	
I should see a red X if has invalid characters
	[Tags]		ChangeEmail
	When I enter the text "@^&#^%^#" in "#newEmailAddress" textbox
	Sleep		${EVENT}
	Then I should see the element ".validation-icon" displayed
	
When I click cancel I should not see the modal
	[Tags]		ChangeEmail
	When i click the "#myblue-account-management-modal-cancel" link
	Sleep		${EVENT}
	Then I should not see the element "form[name=\"f\"]" displayed