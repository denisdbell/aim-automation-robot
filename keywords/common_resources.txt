*** Settings ***
Documentation     A resource file with reusable keywords and variables.
...
...               The system specific keywords created here form our own
...               domain specific language. They utilize keywords provided
...               by the imported Selenium2Library.
Library           Selenium2Library
Library           Collections
# Library        lib/utils.py

*** Variables ***

# ${SERVER}         carepass.com/carepass
${ENVIRONMENT}      qa2www.carepass.com
${CONTEXT}          carepass
${SERVER}        ${ENVIRONMENT}/${CONTEXT}
${BROWSER}        firefox
${PHANTOMJS_REMOTE_URL}    http://localhost:4444
${BROWSER_ALIAS}    main browser
${DELAY}          0

${DEFAULT USER NAME}    ferron.smith
${DEFAULT USER PASSWORD}    Wizard12

${FF_PROFILE}   profiles

# AUTH PAGES
${LOGIN URL}      https://${SERVER}/login
${LOG OUT}        https://${SERVER}/logout
${REGISTRATION URL}        https://${SERVER}/register
${PROD WELCOME URL}    https://www.${SERVER}/
${QA WELCOME URL}    https://${SERVER}/

# APP MANAGEMENT PAGE
${APP URL}        https://${SERVER}/apps
# e.g connecting jawbone :- /connect/provider?appToken=jawbone
${APP CONNECT URL}        https://${SERVER}/connect/provider?appToken=
${FITSYNC CONNECT URL}        https://app.fitsync.com/carepass
${APP STORE URL}    https://${SERVER}/appstore/   #https://qa2www.carepass.com/appstore/22/download


# USER PROFILE PAGE
${BIOGRAPHY URL}        https://${SERVER}/biography

# GOAL URL
${GET STARTED URL}        https://${SERVER}/getstarted                  # Getting started page
${GET STARTED GOAL URL}        ${GET STARTED URL}/goals                 # Goal selection page
${GOAL WIZARD URL}          ${GET STARTED GOAL URL}?goalTemplateId=     # Goal Wizard
${GOAL HISTORY URL}        https://${SERVER}/goals/history              # Goal history page
${GOAL TRACKER URL}         https://${SERVER}/goals/?goal=              # Goal tracking page

# Virtual Run or Walk       1
# Fav Jeans                 2
# Kickstart Weight Loss     4
# Custom goal               9

# PROFILES
${FITNESS PROFILE}      https://${SERVER}/fitness/activity
${NUTRITION PROFILE}      https://${SERVER}/nutrition
${DR VISITS PROFILE}      https://${SERVER}/drvisits
${INSURANCE PROFILE}      https://${SERVER}/insurance
${MOOD PROFILE}      https://${SERVER}/profiles/moods
${SLEEP PROFILE}      https://${SERVER}/profiles/health/sleep
${MEDICATIONS PROFILE}      https://${SERVER}/profiles/health/medications
${BODY MEASUREMENT PROFILE}      https://${SERVER}/profiles/health/bodymeasurements
${LAB RESULTS PROFILE}      https://${SERVER}/profiles/health/labresults
${CONDITIONS PROFILE}      https://${SERVER}/profiles/health/conditions
${LIFESTYLE PROFILE}      https://${SERVER}/lifestyle

# STATIC PAGES
${ITRIAGE URL}      https://${SERVER}/apps/itriage
${HELP URL}      https://${SERVER}/static-page/help

*** Keywords ***

Configure For QA Testing
    Set Suite Variable  ${DEFAULT USER NAME}    ferron.smith
    Open Browser     ${LOGIN URL}    ${BROWSER}      ff_profile_dir=${FF_PROFILE}
    # Open Browser     ${LOGIN URL}    ${BROWSER}

Configure For PROD Testing
    Set Suite Variable  ${DEFAULT USER NAME}    ferron.hanse
    Open Browser    ${LOGIN URL}    ${BROWSER}

Is QA Environment
    ${mode}=    Set Variable If  '${ENVIRONMENT}' == 'qa2www.carepass.com'   TRUE     ELSE     FALSE
    Return From Keyword    ${mode}

Open Browser To Login Page
    [Documentation]    Open Browser ${LOGIN URL} ${BROWSER} ${BROWSER_ALIAS} ${PHANTOMJS_REMOTE_URL}
    ${mode}=    Is QA Environment
    Run Keyword If  '${mode}' == 'TRUE'   Configure For QA Testing     ELSE     Configure For PROD Testing
    Maximize Browser Window
    Set Selenium Speed    ${DELAY}
    Login Page Should Be Open

Login Page Should Be Open
    Title Should Be    Log in | CarePass

Go To Login Page
    Go To    ${LOGIN URL}
    Login Page Should Be Open

Input Username
    [Arguments]    ${username}
    Input Text    USER    ${username}

Input Password
    [Arguments]    ${password}
    Input Text    PASSWORD    ${password}

Logout
    ${mode}=    Is QA Environment
    Run Keyword If  '${mode}' == 'TRUE'   Go To    https://${ENVIRONMENT}/carepass/logout     ELSE     Go To    ${LOG OUT}

Submit Credentials
    Click Link    login-button

Login To App
    [Arguments]    ${username}    ${password}
    Input Username    ${username}
    Input Password    ${password}
    Submit Credentials

Welcome Page Should Be Open
    ${mode}=    Is QA Environment
    Run Keyword If  '${mode}' == 'TRUE'   Location Should Be     ${QA WELCOME URL}     ELSE     Location Should Be     ${PROD WELCOME URL}
    Title Should Be    CarePass

Teardown Take Failure Snapshot
    Run Keyword If Test Failed    Capture Screenshot

Teardown Browser
    Close Browser
